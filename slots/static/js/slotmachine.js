/*极客学院前端组*/
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),Animate=function(){function t(e){_classCallCheck(this,t),this.dom=e}return _createClass(t,[{"key":"run","value":function(t,e,n,r,s,i){var o=this;this.property=t,this.startPos=e,this.endPos=n,this.startTime=(new Date).getTime(),this.duration=r,this.easing=this._Tween(s);var a=setInterval(function(){!1===o._step()&&(clearInterval(a),i&&"function"==typeof i&&i()),o._step()},20)}},{"key":"_step","value":function(){var t=(new Date).getTime();if(t>=this.startTime+this.duration)return this._update(this.endPos),!1;var e=this.easing(t-this.startTime,this.startPos,this.endPos-this.startPos,this.duration);this._update(e)}},{"key":"_update","value":function(t){this.dom.style[this.property]=t+"px"}},{"key":"_Tween","value":function(t){return{"linear":function(t,e,n,r){return n*t/r+e},"easeIn":function(t,e,n,r){return n*(t/=r)*t+e},"easeOut":function(t,e,n,r){return-n*(t/=r)*(t-2)+e},"easeBoth":function(t,e,n,r){return(t/=r/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e},"easeInStrong":function(t,e,n,r){return n*(t/=r)*t*t*t+e},"easeOutStrong":function(t,e,n,r){return-n*((t=t/r-1)*t*t*t-1)+e},"easeBothStrong":function(t,e,n,r){return(t/=r/2)<1?n/2*t*t*t*t+e:-n/2*((t-=2)*t*t*t-2)+e}}[t]}}]),t}(),Game=function(){function t(e){_classCallCheck(this,t),this.counter=0,this.dom=e["dom"],this.property=e["property"],this.startPos=e["startPos"],this.endPos=e["endPos"],this.duration=e["duration"]?e["duration"]:500,this.easing=e["easing"]?e["easing"]:"linear",this.counts=e["counts"]?e["counts"]:10,this.animate=new Animate(this.dom)}return _createClass(t,[{"key":"run","value":function(t,e){var n=this;this.animate.run(this.property,this.startPos,this.endPos,this.duration,this.easing,function(){if(n.counter++,n.counter>=n.counts)return n.counter=0,n.animate.run(n.property,n.startPos,t,800,"easeOut"),e&&"function"==typeof e&&setTimeout(function(){e()},1500),!1;n.dom.style[n.property]=n.startPos+"px",n.run(t,e)})}}]),t}(),VALIDATE=function(){function t(e){_classCallCheck(this,t),this.params=e}return _createClass(t,[{"key":"start","value":function(t){var e=this;Object.getOwnPropertyNames(t).forEach(function(n){var r=_typeof(t[n]),s=e.params[n].split(".")[0],i="isRequired"===e.params[n].split(".")[1],o=s===_typeof(t[n]),a=n+" type should be "+s+" but "+r,u=n+" isRequired!'";if(n){if(i&&!t[n])throw new Error(u);if(!o&&t[n])throw new Error(a)}})}}]),t}(),SlotMachine=function(){function t(e){var n=this;_classCallCheck(this,t),this.validate=new VALIDATE({"params":"object.isRequired","dom":"object.isRequired","property":"string.isRequired","startPos":"number.isRequired","endPos":"number.isRequired","duration":"number.notRequired","easing":"string.notRequired","counts":"number.notRequired","targetPosArray":"object.isRequired","callback":"function.notRequired"}),e.forEach(function(t){n.validate.start({"params":t,"dom":t["dom"],"property":t["property"],"startPos":t["startPos"],"endPos":t["endPos"],"duration":t["duration"],"easing":t["easing"],"counts":t["counts"]})}),this.params=e,this.game=[],this._gameInstance()}return _createClass(t,[{"key":"run","value":function(t,e){this.validate.start({"targetPosArray":t,"callback":e}),this.game.forEach(function(n,r){r===t.length-1?n.run(t[r],function(){e&&"function"==typeof e&&e()}):n.run(t[r])})}},{"key":"_gameInstance","value":function(){var t=this;this.params.forEach(function(e,n){t.game[n]=new Game(e)})}}]),t}();